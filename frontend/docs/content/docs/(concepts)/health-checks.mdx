---
title: Health Checks
description: Monitor and manage upstream health
---

# Health Checks

Octopus monitors upstream health and automatically removes unhealthy instances from rotation.

## Types

### HTTP Health Check

```yaml
upstreams:
  - name: api-service
    instances:
      - address: api-1
        port: 8080
    health_check:
      type: http
      path: /health
      method: GET
      interval: 10s
      timeout: 5s
      healthy_threshold: 2
      unhealthy_threshold: 3
      expected_status: [200, 204]
```

### TCP Health Check

```yaml
upstreams:
  - name: redis
    instances:
      - address: redis-1
        port: 6379
    health_check:
      type: tcp
      interval: 5s
      timeout: 3s
```

### gRPC Health Check

```yaml
upstreams:
  - name: grpc-service
    instances:
      - address: grpc-1
        port: 50051
    health_check:
      type: grpc
      service: grpc.health.v1.Health
      interval: 10s
```

## Active vs Passive

### Active Health Checks

Gateway actively polls instances:

```yaml
health_check:
  type: http
  path: /health
  interval: 10s
```

### Passive Health Detection

Gateway monitors request success/failure:

```yaml
passive_health_check:
  enabled: true
  failure_threshold: 5
  window: 60s
```

## Health States

- **Healthy**: Passing health checks
- **Unhealthy**: Failing health checks
- **Degraded**: Intermittent failures
- **Unknown**: Not yet checked

## Monitoring

```bash
# View health status
curl http://gateway:9090/_/health

# Prometheus metrics
octopus_upstream_health{upstream="api-service",instance="api-1"}
```

## See Also

- [Load Balancing](/docs/concepts/load-balancing)
- [Circuit Breaker](/docs/concepts/circuit-breaker)

